<form [formGroup]="transportForm" (ngSubmit)="onSubmit()" class="transport-form">
  <h2 class="form-title">{{ transport ? 'Edit Transport' : 'Add Transport' }}</h2>

  <!-- Title -->
  <div class="form-group">
    <label for="title" class="form-label">
      Title <span class="required">*</span>
    </label>
    <input
      id="title"
      type="text"
      formControlName="title"
      class="form-control"
      placeholder="e.g., Train to Boston"
      [class.error]="hasError('title')"
    />
    @if (hasError('title')) {
      <span class="error-message">{{ getErrorMessage('title') }}</span>
    }
  </div>

  <!-- Transport Type and Provider Row -->
  <div class="form-row">
    <div class="form-group">
      <label for="transportType" class="form-label">
        Transport Type <span class="required">*</span>
      </label>
      <select
        id="transportType"
        formControlName="transportType"
        class="form-control"
        [class.error]="hasError('transportType')"
      >
        <option value="">Select transport type...</option>
        @for (type of transportTypes; track type.value) {
          <option [value]="type.value">{{ type.label }}</option>
        }
      </select>
      @if (hasError('transportType')) {
        <span class="error-message">{{ getErrorMessage('transportType') }}</span>
      }
    </div>

    <div class="form-group">
      <label for="provider" class="form-label">Provider / Company</label>
      <input
        id="provider"
        type="text"
        formControlName="provider"
        class="form-control"
        placeholder="e.g., Amtrak, Greyhound"
      />
    </div>
  </div>

  <!-- Confirmation Code -->
  <div class="form-group">
    <label for="confirmationCode" class="form-label">Confirmation Code</label>
    <input
      id="confirmationCode"
      type="text"
      formControlName="confirmationCode"
      class="form-control"
      placeholder="e.g., ABC123"
    />
  </div>

  <!-- Departure Section -->
  <fieldset class="form-section">
    <legend class="section-title">Departure Details</legend>

    <div class="form-row">
      <div class="form-group">
        <label for="departureDate" class="form-label">
          Date <span class="required">*</span>
        </label>
        <input
          id="departureDate"
          type="date"
          formControlName="departureDate"
          class="form-control"
          [class.error]="hasError('departureDate')"
        />
        @if (hasError('departureDate')) {
          <span class="error-message">{{ getErrorMessage('departureDate') }}</span>
        }
      </div>

      <div class="form-group">
        <label for="departureTime" class="form-label">
          Time <span class="required">*</span>
        </label>
        <input
          id="departureTime"
          type="time"
          formControlName="departureTime"
          class="form-control"
          [class.error]="hasError('departureTime')"
        />
        @if (hasError('departureTime')) {
          <span class="error-message">{{ getErrorMessage('departureTime') }}</span>
        }
      </div>
    </div>

    <div class="form-group">
      <label for="departureAddress" class="form-label">
        Location / Station <span class="required">*</span>
      </label>
      <input
        id="departureAddress"
        type="text"
        formControlName="departureAddress"
        class="form-control"
        placeholder="e.g., Penn Station, New York"
        [class.error]="hasError('departureAddress')"
        (input)="onDepartureLocationInput()"
      />
      @if (hasError('departureAddress')) {
        <span class="error-message">{{ getErrorMessage('departureAddress') }}</span>
      }
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="departureLatitude" class="form-label">
          Latitude <span class="required">*</span>
        </label>
        <input
          id="departureLatitude"
          type="number"
          step="0.000001"
          formControlName="departureLatitude"
          class="form-control"
          placeholder="e.g., 40.7505"
          [class.error]="hasError('departureLatitude')"
        />
        @if (hasError('departureLatitude')) {
          <span class="error-message">{{ getErrorMessage('departureLatitude') }}</span>
        }
      </div>

      <div class="form-group">
        <label for="departureLongitude" class="form-label">
          Longitude <span class="required">*</span>
        </label>
        <input
          id="departureLongitude"
          type="number"
          step="0.000001"
          formControlName="departureLongitude"
          class="form-control"
          placeholder="e.g., -73.9934"
          [class.error]="hasError('departureLongitude')"
        />
        @if (hasError('departureLongitude')) {
          <span class="error-message">{{ getErrorMessage('departureLongitude') }}</span>
        }
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="departureCity" class="form-label">City</label>
        <input
          id="departureCity"
          type="text"
          formControlName="departureCity"
          class="form-control"
          placeholder="e.g., New York"
        />
      </div>

      <div class="form-group">
        <label for="departureCountry" class="form-label">Country</label>
        <input
          id="departureCountry"
          type="text"
          formControlName="departureCountry"
          class="form-control"
          placeholder="e.g., USA"
        />
      </div>
    </div>
  </fieldset>

  <!-- Arrival Section -->
  <fieldset class="form-section">
    <legend class="section-title">Arrival Details</legend>

    <div class="form-row">
      <div class="form-group">
        <label for="arrivalDate" class="form-label">
          Date <span class="required">*</span>
        </label>
        <input
          id="arrivalDate"
          type="date"
          formControlName="arrivalDate"
          class="form-control"
          [class.error]="hasError('arrivalDate')"
        />
        @if (hasError('arrivalDate')) {
          <span class="error-message">{{ getErrorMessage('arrivalDate') }}</span>
        }
      </div>

      <div class="form-group">
        <label for="arrivalTime" class="form-label">
          Time <span class="required">*</span>
        </label>
        <input
          id="arrivalTime"
          type="time"
          formControlName="arrivalTime"
          class="form-control"
          [class.error]="hasError('arrivalTime')"
        />
        @if (hasError('arrivalTime')) {
          <span class="error-message">{{ getErrorMessage('arrivalTime') }}</span>
        }
      </div>
    </div>

    <div class="form-group">
      <label for="arrivalAddress" class="form-label">
        Location / Station <span class="required">*</span>
      </label>
      <input
        id="arrivalAddress"
        type="text"
        formControlName="arrivalAddress"
        class="form-control"
        placeholder="e.g., South Station, Boston"
        [class.error]="hasError('arrivalAddress')"
        (input)="onArrivalLocationInput()"
      />
      @if (hasError('arrivalAddress')) {
        <span class="error-message">{{ getErrorMessage('arrivalAddress') }}</span>
      }
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="arrivalLatitude" class="form-label">
          Latitude <span class="required">*</span>
        </label>
        <input
          id="arrivalLatitude"
          type="number"
          step="0.000001"
          formControlName="arrivalLatitude"
          class="form-control"
          placeholder="e.g., 42.3519"
          [class.error]="hasError('arrivalLatitude')"
        />
        @if (hasError('arrivalLatitude')) {
          <span class="error-message">{{ getErrorMessage('arrivalLatitude') }}</span>
        }
      </div>

      <div class="form-group">
        <label for="arrivalLongitude" class="form-label">
          Longitude <span class="required">*</span>
        </label>
        <input
          id="arrivalLongitude"
          type="number"
          step="0.000001"
          formControlName="arrivalLongitude"
          class="form-control"
          placeholder="e.g., -71.0552"
          [class.error]="hasError('arrivalLongitude')"
        />
        @if (hasError('arrivalLongitude')) {
          <span class="error-message">{{ getErrorMessage('arrivalLongitude') }}</span>
        }
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="arrivalCity" class="form-label">City</label>
        <input
          id="arrivalCity"
          type="text"
          formControlName="arrivalCity"
          class="form-control"
          placeholder="e.g., Boston"
        />
      </div>

      <div class="form-group">
        <label for="arrivalCountry" class="form-label">Country</label>
        <input
          id="arrivalCountry"
          type="text"
          formControlName="arrivalCountry"
          class="form-control"
          placeholder="e.g., USA"
        />
      </div>
    </div>
  </fieldset>

  <!-- Duration Display -->
  <div class="duration-display">
    <span class="duration-label">Journey Duration:</span>
    <span class="duration-value">{{ formattedDuration() }}</span>
  </div>

  @if (hasDateTimeError()) {
    <div class="form-error">
      Arrival time must be after departure time.
    </div>
  }

  <!-- Notes -->
  <div class="form-group">
    <label for="notes" class="form-label">Notes</label>
    <textarea
      id="notes"
      formControlName="notes"
      class="form-control"
      rows="3"
      placeholder="Additional notes about this journey..."
    ></textarea>
  </div>

  <!-- Form Actions -->
  <div class="form-actions">
    <button type="button" class="btn btn-secondary" (click)="onCancel()">
      Cancel
    </button>
    <button type="submit" class="btn btn-primary">
      {{ transport ? 'Update Transport' : 'Add Transport' }}
    </button>
  </div>
</form>
